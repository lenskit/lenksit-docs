<!DOCTYPE html>
<html class="no-js" lang="en"><!--<![endif]--><head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Matrix Utilities — LensKit 0.10.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css">
  <link rel="stylesheet" href="_static/pygments.css" type="text/css">
    <link rel="index" title="Index" href="genindex.html">
    <link rel="search" title="Search" href="search.html">
    <link rel="next" title="Math utilities" href="math.html">
    <link rel="prev" title="Utility Functions" href="util.html"> 

<!-- RTD Extra Head -->

<!-- 
Always link to the latest version, as canonical.
http://docs.readthedocs.org/en/latest/canonical.html
-->
<link rel="canonical" href="https://lkpy.lenskit.org/stable/matrix.html">



<script type="text/javascript" src="_static/readthedocs-data.js"></script>

<!-- Add page-specific data, which must exist in the page js, not global -->
<script type="text/javascript">
READTHEDOCS_DATA['page'] = "matrix"
READTHEDOCS_DATA['source_suffix'] = ".rst"
</script>

<script type="text/javascript" src="https://assets.readthedocs.org/static/javascript/readthedocs-analytics.js" async="async"></script>

<!-- end RTD <extrahead> -->
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> LensKit
          

          
          </a>

          
            
            
            
              <div class="version">
                0.10.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs">
    <input type="hidden" name="check_keywords" value="yes">
    <input type="hidden" name="area" value="default">
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Install LensKit</a></li>
<li class="toctree-l1"><a class="reference internal" href="GettingStarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/lenskit/lkpy/releases">Release Notes</a></li>
</ul>
<p class="caption"><span class="caption-text">Running Experiments</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="datasets.html">Loading Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="crossfold.html">Splitting Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="batch.html">Batch-Running Recommenders</a></li>
<li class="toctree-l1"><a class="reference internal" href="evaluation/index.html">Evaluating Recommender Output</a></li>
</ul>
<p class="caption"><span class="caption-text">Algorithms</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="interfaces.html">Algorithm Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.html">Algorithm Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic.html">Basic and Utility Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="knn.html">k-NN Collaborative Filtering</a></li>
<li class="toctree-l1"><a class="reference internal" href="mf.html">Classic Matrix Factorization</a></li>
<li class="toctree-l1"><a class="reference internal" href="tf.html">TensorFlow Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="hpf.html">Hierarchical Poisson Factorization</a></li>
<li class="toctree-l1"><a class="reference internal" href="implicit.html">Implicit</a></li>
</ul>
<p class="caption"><span class="caption-text">Tips and Tricks</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="performance.html">Performance Tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="diagnostics.html">Errors and Diagnostics</a></li>
<li class="toctree-l1"><a class="reference internal" href="impl-tips.html">Algorithm Implementation Tips</a></li>
</ul>
<p class="caption"><span class="caption-text">Configuration and Internals</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="util.html">Utility Functions</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Matrix Utilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#building-ratings-matrices">Building Ratings Matrices</a></li>
<li class="toctree-l3"><a class="reference internal" href="#compressed-sparse-row-matrices">Compressed Sparse Row Matrices</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="math.html">Math utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="util.html#module-lenskit.util">Miscellaneous</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="random.html">Random Number Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="internals.html">LensKit Internals</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">LensKit</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> »</li>
        
          <li><a href="util.html">Utility Functions</a> »</li>
        
      <li>Matrix Utilities</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/lenskit/lkpy/blob/0.10.0/doc/matrix.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="module-lenskit.matrix">
<span id="matrix-utilities"></span><h1>Matrix Utilities<a class="headerlink" href="#module-lenskit.matrix" title="Permalink to this headline">¶</a></h1>
<p>We have some matrix-related utilities, since matrices are used so heavily in recommendation
algorithms.</p>
<div class="section" id="building-ratings-matrices">
<h2>Building Ratings Matrices<a class="headerlink" href="#building-ratings-matrices" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="lenskit.matrix.sparse_ratings">
<code class="sig-prename descclassname">lenskit.matrix.</code><code class="sig-name descname">sparse_ratings</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ratings</span></em>, <em class="sig-param"><span class="n">scipy</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">users</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">items</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.matrix.sparse_ratings" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a rating table to a sparse matrix of ratings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ratings</strong> (<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.0.4)"><em>pandas.DataFrame</em></a>) – a data table of (user, item, rating) triples.</p></li>
<li><p><strong>scipy</strong> – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, return a SciPy matrix instead of <a class="reference internal" href="#lenskit.matrix.CSR" title="lenskit.matrix.CSR"><code class="xref py py-class docutils literal notranslate"><span class="pre">CSR</span></code></a>.</p></li>
<li><p><strong>users</strong> (<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Index.html#pandas.Index" title="(in pandas v1.0.4)"><em>pandas.Index</em></a>) – an index of user IDs.</p></li>
<li><p><strong>items</strong> (<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Index.html#pandas.Index" title="(in pandas v1.0.4)"><em>pandas.Index</em></a>) – an index of items IDs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a named tuple containing the sparse matrix, user index, and item index.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lenskit.matrix.RatingMatrix" title="lenskit.matrix.RatingMatrix">RatingMatrix</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="lenskit.matrix.RatingMatrix">
<em class="property">class </em><code class="sig-prename descclassname">lenskit.matrix.</code><code class="sig-name descname">RatingMatrix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">matrix</span></em>, <em class="sig-param"><span class="n">users</span></em>, <em class="sig-param"><span class="n">items</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.matrix.RatingMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a></p>
<p>A rating matrix with associated indices.</p>
<dl class="py attribute">
<dt id="lenskit.matrix.RatingMatrix.matrix">
<code class="sig-name descname">matrix</code><em class="property">: CSR or scipy.sparse.csr_matrix</em><a class="headerlink" href="#lenskit.matrix.RatingMatrix.matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>The rating matrix, with users on rows and items on columns.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lenskit.matrix.RatingMatrix.users">
<code class="sig-name descname">users</code><em class="property">: <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Index.html#pandas.Index" title="(in pandas v1.0.4)">pandas.Index</a></em><a class="headerlink" href="#lenskit.matrix.RatingMatrix.users" title="Permalink to this definition">¶</a></dt>
<dd><p>mapping from user IDs to row numbers.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lenskit.matrix.RatingMatrix.items">
<code class="sig-name descname">items</code><em class="property">: <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Index.html#pandas.Index" title="(in pandas v1.0.4)">pandas.Index</a></em><a class="headerlink" href="#lenskit.matrix.RatingMatrix.items" title="Permalink to this definition">¶</a></dt>
<dd><p>mapping from item IDs to column numbers.</p>
</dd></dl>

<dl class="py method">
<dt id="id0">
<em class="property">property </em><code class="sig-name descname">items</code><a class="headerlink" href="#id0" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py method">
<dt id="id1">
<em class="property">property </em><code class="sig-name descname">matrix</code><a class="headerlink" href="#id1" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py method">
<dt id="id2">
<em class="property">property </em><code class="sig-name descname">users</code><a class="headerlink" href="#id2" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="compressed-sparse-row-matrices">
<h2>Compressed Sparse Row Matrices<a class="headerlink" href="#compressed-sparse-row-matrices" title="Permalink to this headline">¶</a></h2>
<p>We use CSR-format sparse matrices in quite a few places. Since SciPy’s sparse matrices are not
directly usable from Numba, we have implemented a Numba-compiled CSR representation that can
be used from accelerated algorithm implementations.</p>
<dl class="py class">
<dt id="lenskit.matrix.CSR">
<em class="property">class </em><code class="sig-prename descclassname">lenskit.matrix.</code><code class="sig-name descname">CSR</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nrows</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ncols</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nnz</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ptrs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">inds</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">vals</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">N</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.matrix.CSR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Simple compressed sparse row matrix.  This is like <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_matrix.html#scipy.sparse.csr_matrix" title="(in SciPy v1.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.sparse.csr_matrix</span></code></a>, with
a couple of useful differences:</p>
<ul class="simple">
<li><p>It is backed by a Numba jitclass, so it can be directly used from Numba-optimized functions.</p></li>
<li><p>The value array is optional, for cases in which only the matrix structure is required.</p></li>
<li><p>The value array, if present, is always double-precision.</p></li>
</ul>
<p>You generally don’t want to create this class yourself with the constructor.  Instead, use one
of its class methods.</p>
<p>If you need to pass an instance off to a Numba-compiled function, use <a class="reference internal" href="#id3" title="lenskit.matrix.CSR.N"><code class="xref py py-attr docutils literal notranslate"><span class="pre">N</span></code></a>:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">_some_numba_fun</span><span class="p">(</span><span class="n">csr</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
<p>We use the indirection between this and the Numba jitclass so that the main CSR implementation
can be pickled, and so that we can have class and instance methods that are not compatible with
jitclass but which are useful from interpreted code.</p>
<dl class="py attribute">
<dt id="lenskit.matrix.CSR.N">
<code class="sig-name descname">N</code><em class="property">: _CSR</em><a class="headerlink" href="#lenskit.matrix.CSR.N" title="Permalink to this definition">¶</a></dt>
<dd><p>the Numba jitclass backing (has the same attributes and most methods).</p>
</dd></dl>

<dl class="py attribute">
<dt id="lenskit.matrix.CSR.nrows">
<code class="sig-name descname">nrows</code><em class="property">: <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)">int</a></em><a class="headerlink" href="#lenskit.matrix.CSR.nrows" title="Permalink to this definition">¶</a></dt>
<dd><p>the number of rows.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lenskit.matrix.CSR.ncols">
<code class="sig-name descname">ncols</code><em class="property">: <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)">int</a></em><a class="headerlink" href="#lenskit.matrix.CSR.ncols" title="Permalink to this definition">¶</a></dt>
<dd><p>the number of columns.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lenskit.matrix.CSR.nnz">
<code class="sig-name descname">nnz</code><em class="property">: <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)">int</a></em><a class="headerlink" href="#lenskit.matrix.CSR.nnz" title="Permalink to this definition">¶</a></dt>
<dd><p>the number of entries.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lenskit.matrix.CSR.rowptrs">
<code class="sig-name descname">rowptrs</code><em class="property">: <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.18)">numpy.ndarray</a></em><a class="headerlink" href="#lenskit.matrix.CSR.rowptrs" title="Permalink to this definition">¶</a></dt>
<dd><p>the row pointers.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lenskit.matrix.CSR.colinds">
<code class="sig-name descname">colinds</code><em class="property">: <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.18)">numpy.ndarray</a></em><a class="headerlink" href="#lenskit.matrix.CSR.colinds" title="Permalink to this definition">¶</a></dt>
<dd><p>the column indices.</p>
</dd></dl>

<dl class="py attribute">
<dt id="lenskit.matrix.CSR.values">
<code class="sig-name descname">values</code><em class="property">: <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.18)">numpy.ndarray</a></em><a class="headerlink" href="#lenskit.matrix.CSR.values" title="Permalink to this definition">¶</a></dt>
<dd><p>the values</p>
</dd></dl>

<dl class="py method">
<dt id="lenskit.matrix.CSR.empty">
<em class="property">classmethod </em><code class="sig-name descname">empty</code><span class="sig-paren">(</span><em class="sig-param">shape</em>, <em class="sig-param">row_nnzs</em>, <em class="sig-param">*</em>, <em class="sig-param">rpdtype=&lt;class 'numpy.int32'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.matrix.CSR.empty" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an empty CSR matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a>) – the array shape (rows,cols)</p></li>
<li><p><strong>row_nnzs</strong> (<em>array-like</em>) – the number of nonzero entries for each row</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenskit.matrix.CSR.from_coo">
<em class="property">classmethod </em><code class="sig-name descname">from_coo</code><span class="sig-paren">(</span><em class="sig-param">rows</em>, <em class="sig-param">cols</em>, <em class="sig-param">vals</em>, <em class="sig-param">shape=None</em>, <em class="sig-param">rpdtype=&lt;class 'numpy.int32'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.matrix.CSR.from_coo" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a CSR matrix from data in COO format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rows</strong> (<em>array-like</em>) – the row indices.</p></li>
<li><p><strong>cols</strong> (<em>array-like</em>) – the column indices.</p></li>
<li><p><strong>vals</strong> (<em>array-like</em>) – the data values; can be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a>) – the array shape, or <code class="docutils literal notranslate"><span class="pre">None</span></code> to infer from row &amp; column indices.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenskit.matrix.CSR.from_scipy">
<em class="property">classmethod </em><code class="sig-name descname">from_scipy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mat</span></em>, <em class="sig-param"><span class="n">copy</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.matrix.CSR.from_scipy" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a scipy sparse matrix to an internal CSR.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mat</strong> (<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.spmatrix.html#scipy.sparse.spmatrix" title="(in SciPy v1.4.1)"><em>scipy.sparse.spmatrix</em></a>) – a SciPy sparse matrix.</p></li>
<li><p><strong>copy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – if <code class="docutils literal notranslate"><span class="pre">False</span></code>, reuse the SciPy storage if possible.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a CSR matrix.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lenskit.matrix.CSR" title="lenskit.matrix.CSR">CSR</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenskit.matrix.CSR.to_scipy">
<code class="sig-name descname">to_scipy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.matrix.CSR.to_scipy" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a CSR matrix to a SciPy <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_matrix.html#scipy.sparse.csr_matrix" title="(in SciPy v1.4.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.sparse.csr_matrix</span></code></a>.  Avoids copying
if possible.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>self</strong> (<a class="reference internal" href="#lenskit.matrix.CSR" title="lenskit.matrix.CSR"><em>CSR</em></a>) – A CSR matrix.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A SciPy sparse matrix with the same data.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_matrix.html#scipy.sparse.csr_matrix" title="(in SciPy v1.4.1)">scipy.sparse.csr_matrix</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id3">
<em class="property">property </em><code class="sig-name descname">N</code><a class="headerlink" href="#id3" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the native backing array.</p>
</dd></dl>

<dl class="py method">
<dt id="lenskit.matrix.CSR.subset_rows">
<code class="sig-name descname">subset_rows</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">begin</span></em>, <em class="sig-param"><span class="n">end</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.matrix.CSR.subset_rows" title="Permalink to this definition">¶</a></dt>
<dd><p>Subset the rows in this matrix.</p>
</dd></dl>

<dl class="py method">
<dt id="lenskit.matrix.CSR.rowinds">
<code class="sig-name descname">rowinds</code><span class="sig-paren">(</span><span class="sig-paren">)</span> → <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.18)">numpy.ndarray</a><a class="headerlink" href="#lenskit.matrix.CSR.rowinds" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the row indices from this array.  Combined with <a class="reference internal" href="#lenskit.matrix.CSR.colinds" title="lenskit.matrix.CSR.colinds"><code class="xref py py-attr docutils literal notranslate"><span class="pre">colinds</span></code></a> and
<a class="reference internal" href="#lenskit.matrix.CSR.values" title="lenskit.matrix.CSR.values"><code class="xref py py-attr docutils literal notranslate"><span class="pre">values</span></code></a>, this can form a COO-format sparse matrix.</p>
</dd></dl>

<dl class="py method">
<dt id="lenskit.matrix.CSR.row">
<code class="sig-name descname">row</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">row</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.matrix.CSR.row" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a row of this matrix as a dense ndarray.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – the row index.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the row, with 0s in the place of missing values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.18)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenskit.matrix.CSR.row_extent">
<code class="sig-name descname">row_extent</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">row</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.matrix.CSR.row_extent" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the extent of a row in the underlying column index and value arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – the row index.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">(s,</span> <span class="pre">e)</span></code>, where the row occupies positions <span class="math notranslate nohighlight">\([s, e)\)</span> in the
CSR data.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.8)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenskit.matrix.CSR.row_cs">
<code class="sig-name descname">row_cs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">row</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.matrix.CSR.row_cs" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the column indcies for the stored values of a row.</p>
</dd></dl>

<dl class="py method">
<dt id="lenskit.matrix.CSR.row_vs">
<code class="sig-name descname">row_vs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">row</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.matrix.CSR.row_vs" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the stored values of a row.</p>
</dd></dl>

<dl class="py method">
<dt id="lenskit.matrix.CSR.row_nnzs">
<code class="sig-name descname">row_nnzs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.matrix.CSR.row_nnzs" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a vector of the number of nonzero entries in each row.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is not available from Numba.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the number of nonzero entries in each row.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.18)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenskit.matrix.CSR.normalize_rows">
<code class="sig-name descname">normalize_rows</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">normalization</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.matrix.CSR.normalize_rows" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalize the rows of the matrix.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The normalization <em>ignores</em> missing values instead of treating
them as 0.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is not available from Numba.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>normalization</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – </p><p>The normalization to perform. Can be one of:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'center'</span></code> - center rows about the mean</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'unit'</span></code> - convert rows to a unit vector</p></li>
</ul>
<p></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The normalization values for each row.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.18)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenskit.matrix.CSR.transpose">
<code class="sig-name descname">transpose</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">values</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.matrix.CSR.transpose" title="Permalink to this definition">¶</a></dt>
<dd><p>Transpose a CSR matrix.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is not available from Numba.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>values</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – whether to include the values in the transpose.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the transpose of this matrix (or, equivalently, this matrix in CSC format).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lenskit.matrix.CSR" title="lenskit.matrix.CSR">CSR</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="lenskit.matrix.CSR.filter_nnzs">
<code class="sig-name descname">filter_nnzs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filt</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.matrix.CSR.filter_nnzs" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter the values along the full NNZ axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filt</strong> (<em>ndarray</em>) – a logical array of length <a class="reference internal" href="#lenskit.matrix.CSR.nnz" title="lenskit.matrix.CSR.nnz"><code class="xref py py-attr docutils literal notranslate"><span class="pre">nnz</span></code></a> that indicates the values to keep.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The filtered sparse matrix.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#lenskit.matrix.CSR" title="lenskit.matrix.CSR">CSR</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="lenskit.matrix._CSR">
<em class="property">class </em><code class="sig-prename descclassname">lenskit.matrix.</code><code class="sig-name descname">_CSR</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nrows</span></em>, <em class="sig-param"><span class="n">ncols</span></em>, <em class="sig-param"><span class="n">nnz</span></em>, <em class="sig-param"><span class="n">ptrs</span></em>, <em class="sig-param"><span class="n">inds</span></em>, <em class="sig-param"><span class="n">vals</span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.matrix._CSR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Internal implementation class for <a class="reference internal" href="#lenskit.matrix.CSR" title="lenskit.matrix.CSR"><code class="xref py py-class docutils literal notranslate"><span class="pre">CSR</span></code></a>. If you work with CSRs from Numba,
you will use a <code class="xref py py-func docutils literal notranslate"><span class="pre">numba.jitclass()</span></code>-ed version of this.</p>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">values</span></code> array is always present (unlike the Python shim), but is
zero-length if no values are present.  This eases Numba type-checking.</p>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="math.html" class="btn btn-neutral float-right" title="Math utilities" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="util.html" class="btn btn-neutral float-left" title="Utility Functions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr>

  <div role="contentinfo">
    <p>
        © Copyright 2018–2019 Boise State University
      
        <span class="commit">
          Revision <code>58256cdc</code>.
        </span>
      

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
<p>This material is based upon work supported by the National Science Foundation under
Grant No. <a href="https://md.ekstrandom.net/research/career">IIS 17-51278</a>. Any
opinions, findings, and conclusions or recommendations expressed in this material
are those of the author(s) and do not necessarily reflect the views of the
National Science Foundation.  This page has not been approved by
Boise State University and does not reflect official university positions.</p>
<script data-goatcounter="https://lenskit.goatcounter.com/count" async="" src="//gc.zgo.at/count.js"></script>


</footer>

        </div>
      </div>

    </section>

  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: 0.10.0
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
        
          <dd><a href="/en/latest/">latest</a></dd>
        
          <dd><a href="/en/stable/">stable</a></dd>
        
          <dd><a href="/en/0.10.0/">0.10.0</a></dd>
        
          <dd><a href="/en/0.9.0/">0.9.0</a></dd>
        
          <dd><a href="/en/0.8.4/">0.8.4</a></dd>
        
          <dd><a href="/en/0.8.1/">0.8.1</a></dd>
        
          <dd><a href="/en/0.8.0/">0.8.0</a></dd>
        
          <dd><a href="/en/0.7.0/">0.7.0</a></dd>
        
          <dd><a href="/en/0.6.1/">0.6.1</a></dd>
        
          <dd><a href="/en/0.6.0/">0.6.0</a></dd>
        
          <dd><a href="/en/0.5.0/">0.5.0</a></dd>
        
          <dd><a href="/en/0.3.0/">0.3.0</a></dd>
        
          <dd><a href="/en/0.2.0/">0.2.0</a></dd>
        
          <dd><a href="/en/0.1.0/">0.1.0</a></dd>
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
      </dl>
      <dl>
        <dt>On Read the Docs</dt>
          <dd>
            <a href="//readthedocs.org/projects/lkpy/?fromdocs=lkpy">Project Home</a>
          </dd>
          <dd>
            <a href="//readthedocs.org/builds/lkpy/?fromdocs=lkpy">Builds</a>
          </dd>
      </dl>
      <hr>
      Free document hosting provided by <a href="http://www.readthedocs.org">Read the Docs</a>.

    </div>
  </div>



  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
   


</body></html>