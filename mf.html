

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Classic Matrix Factorization &mdash; LensKit 0.13.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />

  
  

  
  

  
    <link rel="canonical" href="https://lkpy.readthedocs.io/en/stable/mf.html" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "document", "processHtmlClass": "math|output_area"}}</script>
        <script async="async" src="https://assets.readthedocs.org/static/javascript/readthedocs-doc-embed.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="TensorFlow Algorithms" href="tf.html" />
    <link rel="prev" title="k-NN Collaborative Filtering" href="knn.html" /> 

<!-- RTD Extra Head -->

<link rel="stylesheet" href="https://assets.readthedocs.org/static/css/readthedocs-doc-embed.css" type="text/css" />

<script type="application/json" id="READTHEDOCS_DATA">{"ad_free": false, "api_host": "https://readthedocs.org", "build_date": "2021-06-22T17:08:15Z", "builder": "sphinx", "canonical_url": null, "commit": "0678cd1d", "docroot": "/doc/", "features": {"docsearch_disabled": false}, "global_analytics_code": "UA-17997319-1", "language": "en", "page": "mf", "programming_language": "py", "project": "lkpy", "proxied_api_host": "/_", "source_suffix": ".rst", "subprojects": {}, "theme": "sphinx_rtd_theme", "user_analytics_code": "", "version": "0.13.1"}</script>

<!--
Using this variable directly instead of using `JSON.parse` is deprecated.
The READTHEDOCS_DATA global variable will be removed in the future.
-->
<script type="text/javascript">
READTHEDOCS_DATA = JSON.parse(document.getElementById('READTHEDOCS_DATA').innerHTML);
</script>

<script type="text/javascript" src="https://assets.readthedocs.org/static/javascript/readthedocs-analytics.js" async="async"></script>

<!-- end RTD <extrahead> -->
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> LensKit
          

          
          </a>

          
            
            
            
              <div class="version">
                0.13.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Install LensKit</a></li>
<li class="toctree-l1"><a class="reference internal" href="GettingStarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/lenskit/lkpy/releases">Release Notes</a></li>
</ul>
<p class="caption"><span class="caption-text">Running Experiments</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="datasets.html">Loading Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="crossfold.html">Splitting Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="batch.html">Batch-Running Recommenders</a></li>
<li class="toctree-l1"><a class="reference internal" href="evaluation/index.html">Evaluating Recommender Output</a></li>
</ul>
<p class="caption"><span class="caption-text">Algorithms</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="interfaces.html">Algorithm Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.html">Algorithm Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic.html">Basic and Utility Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="ranking.html">Ranking Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="bias.html">Bias</a></li>
<li class="toctree-l1"><a class="reference internal" href="knn.html">k-NN Collaborative Filtering</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Classic Matrix Factorization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-lenskit.algorithms.mf_common">Common Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lenskit.algorithms.als">Alternating Least Squares</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-lenskit.algorithms.svd">SciKit SVD</a></li>
<li class="toctree-l2"><a class="reference internal" href="#funksvd">FunkSVD</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tf.html">TensorFlow Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="hpf.html">Hierarchical Poisson Factorization</a></li>
<li class="toctree-l1"><a class="reference internal" href="implicit.html">Implicit</a></li>
</ul>
<p class="caption"><span class="caption-text">Tips and Tricks</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="performance.html">Performance Tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="diagnostics.html">Errors and Diagnostics</a></li>
<li class="toctree-l1"><a class="reference internal" href="impl-tips.html">Algorithm Implementation Tips</a></li>
</ul>
<p class="caption"><span class="caption-text">Configuration and Internals</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="util.html">Utility Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="internals.html">LensKit Internals</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">LensKit</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Classic Matrix Factorization</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com/lenskit/lkpy/blob/0.13.1/doc/mf.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="classic-matrix-factorization">
<h1>Classic Matrix Factorization<a class="headerlink" href="#classic-matrix-factorization" title="Permalink to this headline">Â¶</a></h1>
<p>LKPY provides classical matrix factorization implementations.</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#module-lenskit.algorithms.mf_common" id="id14">Common Support</a></p></li>
<li><p><a class="reference internal" href="#module-lenskit.algorithms.als" id="id15">Alternating Least Squares</a></p></li>
<li><p><a class="reference internal" href="#module-lenskit.algorithms.svd" id="id16">SciKit SVD</a></p></li>
<li><p><a class="reference internal" href="#funksvd" id="id17">FunkSVD</a></p></li>
</ul>
</div>
<div class="section" id="module-lenskit.algorithms.mf_common">
<span id="common-support"></span><h2><a class="toc-backref" href="#id14">Common Support</a><a class="headerlink" href="#module-lenskit.algorithms.mf_common" title="Permalink to this headline">Â¶</a></h2>
<p>The <code class="xref py py-mod docutils literal notranslate"><span class="pre">mf_common</span></code> module contains common support code for matrix factorization
algorithms.  This class, <a class="reference internal" href="#lenskit.algorithms.mf_common.MFPredictor" title="lenskit.algorithms.mf_common.MFPredictor"><code class="xref py py-class docutils literal notranslate"><span class="pre">MFPredictor</span></code></a>,
defines the parameters that are estimated during the <a class="reference internal" href="interfaces.html#lenskit.Algorithm.fit" title="lenskit.Algorithm.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Algorithm.fit()</span></code></a>
process on common matrix factorization algorithms.</p>
<dl class="py class">
<dt class="sig sig-object py" id="lenskit.algorithms.mf_common.MFPredictor">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">lenskit.algorithms.mf_common.</span></span><span class="sig-name descname"><span class="pre">MFPredictor</span></span><a class="headerlink" href="#lenskit.algorithms.mf_common.MFPredictor" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="interfaces.html#lenskit.Predictor" title="lenskit.Predictor"><code class="xref py py-class docutils literal notranslate"><span class="pre">lenskit.Predictor</span></code></a></p>
<p>Common predictor for matrix factorization.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="lenskit.algorithms.mf_common.MFPredictor.user_index_">
<span class="sig-name descname"><span class="pre">user_index_</span></span><a class="headerlink" href="#lenskit.algorithms.mf_common.MFPredictor.user_index_" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Users in the model (length=:math:<cite>m</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Index.html#pandas.Index" title="(in pandas v1.2.5)">pandas.Index</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lenskit.algorithms.mf_common.MFPredictor.item_index_">
<span class="sig-name descname"><span class="pre">item_index_</span></span><a class="headerlink" href="#lenskit.algorithms.mf_common.MFPredictor.item_index_" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Items in the model (length=:math:<cite>n</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Index.html#pandas.Index" title="(in pandas v1.2.5)">pandas.Index</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lenskit.algorithms.mf_common.MFPredictor.user_features_">
<span class="sig-name descname"><span class="pre">user_features_</span></span><a class="headerlink" href="#lenskit.algorithms.mf_common.MFPredictor.user_features_" title="Permalink to this definition">Â¶</a></dt>
<dd><p>The <span class="math notranslate nohighlight">\(m \times k\)</span> user-feature matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lenskit.algorithms.mf_common.MFPredictor.item_features_">
<span class="sig-name descname"><span class="pre">item_features_</span></span><a class="headerlink" href="#lenskit.algorithms.mf_common.MFPredictor.item_features_" title="Permalink to this definition">Â¶</a></dt>
<dd><p>The <span class="math notranslate nohighlight">\(n \times k\)</span> item-feature matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lenskit.algorithms.mf_common.MFPredictor.n_features">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">n_features</span></span><a class="headerlink" href="#lenskit.algorithms.mf_common.MFPredictor.n_features" title="Permalink to this definition">Â¶</a></dt>
<dd><p>The number of features.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lenskit.algorithms.mf_common.MFPredictor.n_users">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">n_users</span></span><a class="headerlink" href="#lenskit.algorithms.mf_common.MFPredictor.n_users" title="Permalink to this definition">Â¶</a></dt>
<dd><p>The number of users.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lenskit.algorithms.mf_common.MFPredictor.n_items">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">n_items</span></span><a class="headerlink" href="#lenskit.algorithms.mf_common.MFPredictor.n_items" title="Permalink to this definition">Â¶</a></dt>
<dd><p>The number of items.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lenskit.algorithms.mf_common.MFPredictor.lookup_user">
<span class="sig-name descname"><span class="pre">lookup_user</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.algorithms.mf_common.MFPredictor.lookup_user" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Look up the index for a user.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>user</strong> â the user ID to look up</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the user index.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lenskit.algorithms.mf_common.MFPredictor.lookup_items">
<span class="sig-name descname"><span class="pre">lookup_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">items</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.algorithms.mf_common.MFPredictor.lookup_items" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Look up the indices for a set of items.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>items</strong> (<em>array-like</em>) â the item IDs to look up.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the item indices. Unknown items will have negative indices.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lenskit.algorithms.mf_common.MFPredictor.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.algorithms.mf_common.MFPredictor.score" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Score a set of items for a user. User and item parameters must be indices
into the matrices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>user</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) â the user index</p></li>
<li><p><strong>items</strong> (<em>array-like of int</em>) â the item indices</p></li>
<li><p><strong>raw</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) â if <code class="docutils literal notranslate"><span class="pre">True</span></code>, do return raw scores without biases added back.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the scores for the items.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.20)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-lenskit.algorithms.als">
<span id="alternating-least-squares"></span><h2><a class="toc-backref" href="#id15">Alternating Least Squares</a><a class="headerlink" href="#module-lenskit.algorithms.als" title="Permalink to this headline">Â¶</a></h2>
<p>LensKit provides alternating least squares implementations of matrix factorization suitable
for explicit feedback data.  These implementations are parallelized with Numba, and perform
best with the MKL from Conda.</p>
<dl class="py class">
<dt class="sig sig-object py" id="lenskit.algorithms.als.BiasedMF">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">lenskit.algorithms.als.</span></span><span class="sig-name descname"><span class="pre">BiasedMF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">features</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">damping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng_spec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_user_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.algorithms.als.BiasedMF" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lenskit.algorithms.mf_common.MFPredictor" title="lenskit.algorithms.mf_common.MFPredictor"><code class="xref py py-class docutils literal notranslate"><span class="pre">lenskit.algorithms.mf_common.MFPredictor</span></code></a></p>
<p>Biased matrix factorization trained with alternating least squares <a class="reference internal" href="#zwsp2008" id="id1"><span>[ZWSP2008]</span></a>.  This is a
prediction-oriented algorithm suitable for explicit feedback data.</p>
<p>It provides two solvers for the optimization step (the <cite>method</cite> parameter):</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'cd'</span></code> (the default)</dt><dd><p>Coordinate descent <a class="reference internal" href="#id9" id="id2"><span>[TPT2011]</span></a>, adapted for a separately-trained bias model and to use
weighted regularization as in the original ALS paper <a class="reference internal" href="#zwsp2008" id="id3"><span>[ZWSP2008]</span></a>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'lu'</span></code></dt><dd><p>A direct implementation of the original ALS concept <a class="reference internal" href="#zwsp2008" id="id4"><span>[ZWSP2008]</span></a> using LU-decomposition
to solve for the optimized matrices.</p>
</dd>
</dl>
<p>See the base class <a class="reference internal" href="#lenskit.algorithms.mf_common.MFPredictor" title="lenskit.algorithms.mf_common.MFPredictor"><code class="xref py py-class docutils literal notranslate"><span class="pre">MFPredictor</span></code></a> for documentation on
the estimated parameters you can extract from a trained model.</p>
<dl class="citation">
<dt class="label" id="zwsp2008"><span class="brackets">ZWSP2008</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id3">2</a>,<a href="#id4">3</a>)</span></dt>
<dd><p>Yunhong Zhou, Dennis Wilkinson, Robert Schreiber, and Rong Pan. 2008.
Large-Scale Parallel Collaborative Filtering for the Netflix Prize.
In +Algorithmic Aspects in Information and <a href="#id18"><span class="problematic" id="id19">Management_</span></a>, LNCS 5034, 337â348.
DOI <a class="reference external" href="http://dx.doi.org/10.1007/978-3-540-68880-8_32">10.1007/978-3-540-68880-8_32</a>.</p>
</dd>
<dt class="label" id="tpt2011"><span class="brackets">TPT2011</span></dt>
<dd><p>GÃ¡bor TakÃ¡cs, IstvÃ¡n PilÃ¡szy, and Domonkos Tikk. 2011. Applications of the
Conjugate Gradient Method for Implicit Feedback Collaborative Filtering.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>features</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) â the number of features to train</p></li>
<li><p><strong>iterations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) â the number of iterations to train</p></li>
<li><p><strong>reg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) â the regularization factor; can also be a tuple <code class="docutils literal notranslate"><span class="pre">(ureg,</span> <span class="pre">ireg)</span></code> to
specify separate user and item regularization terms.</p></li>
<li><p><strong>damping</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><em>float</em></a>) â damping factor for the underlying bias.</p></li>
<li><p><strong>bias</strong> (bool or <code class="xref py py-class docutils literal notranslate"><span class="pre">Bias</span></code>) â the bias model.  If <code class="docutils literal notranslate"><span class="pre">True</span></code>, fits a <code class="xref py py-class docutils literal notranslate"><span class="pre">Bias</span></code> with
damping <code class="docutils literal notranslate"><span class="pre">damping</span></code>.</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) â the solver to use (see above).</p></li>
<li><p><strong>rng_spec</strong> â Random number generator or state (see <code class="xref py py-func docutils literal notranslate"><span class="pre">lenskit.util.random.rng()</span></code>).</p></li>
<li><p><strong>progress</strong> â a <code class="xref py py-func docutils literal notranslate"><span class="pre">tqdm.tqdm()</span></code>-compatible progress bar function</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="lenskit.algorithms.als.BiasedMF.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ratings</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.algorithms.als.BiasedMF.fit" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Run ALS to train a model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ratings</strong> â the ratings data frame.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The algorithm (for chaining).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lenskit.algorithms.als.BiasedMF.fit_iters">
<span class="sig-name descname"><span class="pre">fit_iters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ratings</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.algorithms.als.BiasedMF.fit_iters" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Run ALS to train a model, returning each iteration as a generator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ratings</strong> â the ratings data frame.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The algorithm (for chaining).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lenskit.algorithms.als.BiasedMF.predict_for_user">
<span class="sig-name descname"><span class="pre">predict_for_user</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.algorithms.als.BiasedMF.predict_for_user" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Compute predictions for a user and items.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>user</strong> â the user ID</p></li>
<li><p><strong>items</strong> (<em>array-like</em>) â the items to predict</p></li>
<li><p><strong>ratings</strong> (<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v1.2.5)"><em>pandas.Series</em></a>) â the userâs ratings (indexed by item id); if provided, they may be used to
override or augment the modelâs notion of a userâs preferences.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>scores for the items, indexed by item id.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v1.2.5)">pandas.Series</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lenskit.algorithms.als.ImplicitMF">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">lenskit.algorithms.als.</span></span><span class="sig-name descname"><span class="pre">ImplicitMF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">features</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_ratings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cg'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rng_spec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_user_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.algorithms.als.ImplicitMF" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lenskit.algorithms.mf_common.MFPredictor" title="lenskit.algorithms.mf_common.MFPredictor"><code class="xref py py-class docutils literal notranslate"><span class="pre">lenskit.algorithms.mf_common.MFPredictor</span></code></a></p>
<p>Implicit matrix factorization trained with alternating least squares <a class="reference internal" href="#hkv2008" id="id6"><span>[HKV2008]</span></a>.  This
algorithm outputs âpredictionsâ, but they are not on a meaningful scale.  If its input
data contains <code class="docutils literal notranslate"><span class="pre">rating</span></code> values, these will be used as the âconfidenceâ values; otherwise,
confidence will be 1 for every rated item.</p>
<p>See the base class <a class="reference internal" href="#lenskit.algorithms.mf_common.MFPredictor" title="lenskit.algorithms.mf_common.MFPredictor"><code class="xref py py-class docutils literal notranslate"><span class="pre">MFPredictor</span></code></a> for documentation on the estimated parameters
you can extract from a trained model.</p>
<p>With weight <span class="math notranslate nohighlight">\(w\)</span>, this function decomposes the matrix <a href="#id7"><span class="problematic" id="id8">:matrix:`\mathbb{1}^* + Rw`</span></a>, where
$mathbb{1}^*$ is an $m times n$ matrix of all 1s.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In versions prior to 0.13, <code class="docutils literal notranslate"><span class="pre">ImplicitMF</span></code> used the rating column if it was present.
In 0.13, we added an option to control whether or not the rating column is used; it
currently defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>, but with a warning.  In LensKit for Python 0.14,
<strong>this default will change</strong>.</p>
</div>
<dl class="citation">
<dt class="label" id="hkv2008"><span class="brackets">HKV2008</span><span class="fn-backref">(<a href="#id6">1</a>,<a href="#id10">2</a>,<a href="#id12">3</a>)</span></dt>
<dd><p>Y. Hu, Y. Koren, and C. Volinsky. 2008.
Collaborative Filtering for Implicit Feedback Datasets.
In _Proceedings of the 2008 Eighth IEEE International Conference on Data <a href="#id20"><span class="problematic" id="id21">Mining_</span></a>, 263â272.
DOI <a class="reference external" href="http://dx.doi.org/10.1109/ICDM.2008.22">10.1109/ICDM.2008.22</a></p>
</dd>
<dt class="label" id="id9"><span class="brackets">TPT2011</span></dt>
<dd><p>GÃ¡bor TakÃ¡cs, IstvÃ¡n PilÃ¡szy, and Domonkos Tikk. 2011. Applications of the
Conjugate Gradient Method for Implicit Feedback Collaborative Filtering.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>features</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) â the number of features to train</p></li>
<li><p><strong>iterations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) â the number of iterations to train</p></li>
<li><p><strong>reg</strong> (<em>double</em>) â the regularization factor</p></li>
<li><p><strong>weight</strong> (<em>double</em>) â the scaling weight for positive samples (<span class="math notranslate nohighlight">\(\alpha\)</span> in <a class="reference internal" href="#hkv2008" id="id10"><span>[HKV2008]</span></a>).</p></li>
<li><p><strong>use_ratings</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) â Whether to use the <cite>rating</cite> column, if present.  Currently defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>; this
default will change in LensKit 0.14.  When <code class="docutils literal notranslate"><span class="pre">True</span></code>, the values from the <code class="docutils literal notranslate"><span class="pre">rating</span></code>
column are used, and multipled by <code class="docutils literal notranslate"><span class="pre">weight</span></code>; if <code class="docutils literal notranslate"><span class="pre">False</span></code>, ImplicitMF treats every
user-item pair as having a rating of 1.</p></li>
<li><p><strong>method</strong> (<em>string</em>) â <p>the training method.</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'cg'</span></code> (the default)</dt><dd><p>Conjugate gradient method <a class="reference internal" href="#id9" id="id11"><span>[TPT2011]</span></a>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'lu'</span></code></dt><dd><p>A direct implementation of the original implicit-feedback ALS concept <a class="reference internal" href="#hkv2008" id="id12"><span>[HKV2008]</span></a>
using LU-decomposition to solve for the optimized matrices.</p>
</dd>
</dl>
</p></li>
<li><p><strong>rng_spec</strong> â Random number generator or state (see <code class="xref py py-func docutils literal notranslate"><span class="pre">lenskit.util.random.rng()</span></code>).</p></li>
<li><p><strong>progress</strong> â a <code class="xref py py-func docutils literal notranslate"><span class="pre">tqdm.tqdm()</span></code>-compatible progress bar function</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="lenskit.algorithms.als.ImplicitMF.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ratings</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.algorithms.als.ImplicitMF.fit" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Train a model using the specified ratings (or similar) data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ratings</strong> (<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.2.5)"><em>pandas.DataFrame</em></a>) â The ratings data.</p></li>
<li><p><strong>kwargs</strong> â Additional training data the algorithm may require.  Algorithms should
avoid using the same keyword arguments for different purposes, so that
they can be more easily hybridized.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The algorithm object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lenskit.algorithms.als.ImplicitMF.predict_for_user">
<span class="sig-name descname"><span class="pre">predict_for_user</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.algorithms.als.ImplicitMF.predict_for_user" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Compute predictions for a user and items.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>user</strong> â the user ID</p></li>
<li><p><strong>items</strong> (<em>array-like</em>) â the items to predict</p></li>
<li><p><strong>ratings</strong> (<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v1.2.5)"><em>pandas.Series</em></a>) â the userâs ratings (indexed by item id); if provided, they may be used to
override or augment the modelâs notion of a userâs preferences.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>scores for the items, indexed by item id.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v1.2.5)">pandas.Series</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-lenskit.algorithms.svd">
<span id="scikit-svd"></span><h2><a class="toc-backref" href="#id16">SciKit SVD</a><a class="headerlink" href="#module-lenskit.algorithms.svd" title="Permalink to this headline">Â¶</a></h2>
<p>This code implements a traditional SVD using scikit-learn.  It requires <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> to
be installed in order to function.</p>
<dl class="py class">
<dt class="sig sig-object py" id="lenskit.algorithms.svd.BiasedSVD">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">lenskit.algorithms.svd.</span></span><span class="sig-name descname"><span class="pre">BiasedSVD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">features</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">damping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'randomized'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.algorithms.svd.BiasedSVD" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="interfaces.html#lenskit.Predictor" title="lenskit.Predictor"><code class="xref py py-class docutils literal notranslate"><span class="pre">lenskit.Predictor</span></code></a></p>
<p>Biased matrix factorization for implicit feedback using SciKit-Learnâs SVD
solver (<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.TruncatedSVD.html#sklearn.decomposition.TruncatedSVD" title="(in scikit-learn v0.24)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.decomposition.TruncatedSVD</span></code></a>).  It operates by first
computing the bias, then computing the SVD of the bias residuals.</p>
<p>Youâll generally want one of the iterative SVD implementations such as
<code class="xref py py-class docutils literal notranslate"><span class="pre">lennskit.algorithms.als.BiasedMF</span></code>; this is here primarily as an
example and for cases where you want to evaluate a pure SVD implementation.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lenskit.algorithms.svd.BiasedSVD.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ratings</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.algorithms.svd.BiasedSVD.fit" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Train a model using the specified ratings (or similar) data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ratings</strong> (<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.2.5)"><em>pandas.DataFrame</em></a>) â The ratings data.</p></li>
<li><p><strong>kwargs</strong> â Additional training data the algorithm may require.  Algorithms should
avoid using the same keyword arguments for different purposes, so that
they can be more easily hybridized.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The algorithm object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lenskit.algorithms.svd.BiasedSVD.predict_for_user">
<span class="sig-name descname"><span class="pre">predict_for_user</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.algorithms.svd.BiasedSVD.predict_for_user" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Compute predictions for a user and items.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>user</strong> â the user ID</p></li>
<li><p><strong>items</strong> (<em>array-like</em>) â the items to predict</p></li>
<li><p><strong>ratings</strong> (<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v1.2.5)"><em>pandas.Series</em></a>) â the userâs ratings (indexed by item id); if provided, they may be used to
override or augment the modelâs notion of a userâs preferences.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>scores for the items, indexed by item id.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v1.2.5)">pandas.Series</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lenskit.algorithms.svd.BiasedSVD.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.algorithms.svd.BiasedSVD.get_params" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Get the parameters for this algorithm (as in scikit-learn).  Algorithm parameters
should match constructor argument names.</p>
<p>The default implementation returns all attributes that match a constructor parameter
name.  It should be compatible with <code class="xref py py-meth docutils literal notranslate"><span class="pre">scikit.base.BaseEstimator.get_params()</span></code>
method so that LensKit alogrithms can be cloned with <code class="xref py py-func docutils literal notranslate"><span class="pre">scikit.base.clone()</span></code>
as well as <a class="reference internal" href="util.html#lenskit.util.clone" title="lenskit.util.clone"><code class="xref py py-func docutils literal notranslate"><span class="pre">lenskit.util.clone()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the algorithm parameters.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="funksvd">
<h2><a class="toc-backref" href="#id17">FunkSVD</a><a class="headerlink" href="#funksvd" title="Permalink to this headline">Â¶</a></h2>
<span class="target" id="module-lenskit.algorithms.funksvd"></span><p><a class="reference external" href="http://sifter.org/~simon/journal/20061211.html">FunkSVD</a> is an SVD-like matrix factorization that uses stochastic gradient
descent, configured much like coordinate descent, to train the user-feature and
item-feature matrices.  We generally donât recommend using it in new
applications or experiments; the ALS-based algorithms are less sensitive to
hyperparameters, and the TensorFlow algorithms provide more optimized gradient
descent training of the same prediction model.</p>
<dl class="py class">
<dt class="sig sig-object py" id="lenskit.algorithms.funksvd.FunkSVD">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">lenskit.algorithms.funksvd.</span></span><span class="sig-name descname"><span class="pre">FunkSVD</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lrate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.015</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">damping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.algorithms.funksvd.FunkSVD" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lenskit.algorithms.mf_common.MFPredictor" title="lenskit.algorithms.mf_common.MFPredictor"><code class="xref py py-class docutils literal notranslate"><span class="pre">lenskit.algorithms.mf_common.MFPredictor</span></code></a></p>
<p>Algorithm class implementing FunkSVD matrix factorization.  FunkSVD is a regularized
biased matrix factorization technique trained with featurewise stochastic gradient
descent.</p>
<p>See the base class <a class="reference internal" href="#lenskit.algorithms.mf_common.MFPredictor" title="lenskit.algorithms.mf_common.MFPredictor"><code class="xref py py-class docutils literal notranslate"><span class="pre">MFPredictor</span></code></a> for documentation on the estimated parameters
you can extract from a trained model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>features</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) â the number of features to train</p></li>
<li><p><strong>iterations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) â the number of iterations to train each feature</p></li>
<li><p><strong>lrate</strong> (<em>double</em>) â the learning rate</p></li>
<li><p><strong>reg</strong> (<em>double</em>) â the regularization factor</p></li>
<li><p><strong>damping</strong> (<em>double</em>) â damping factor for the underlying mean</p></li>
<li><p><strong>bias</strong> (<a class="reference internal" href="interfaces.html#lenskit.Predictor" title="lenskit.Predictor"><em>Predictor</em></a>) â the underlying bias model to fit.  If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then a
<a class="reference internal" href="bias.html#lenskit.algorithms.bias.Bias" title="lenskit.algorithms.bias.Bias"><code class="xref py py-class docutils literal notranslate"><span class="pre">bias.Bias</span></code></a> model is fit with <code class="docutils literal notranslate"><span class="pre">damping</span></code>.</p></li>
<li><p><strong>range</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><em>tuple</em></a>) â the <code class="docutils literal notranslate"><span class="pre">(min,</span> <span class="pre">max)</span></code> rating values to clamp ratings, or <code class="docutils literal notranslate"><span class="pre">None</span></code> to leave
predictions unclamped.</p></li>
<li><p><strong>random_state</strong> â The random state for shuffling the data prior to training.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="lenskit.algorithms.funksvd.FunkSVD.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ratings</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.algorithms.funksvd.FunkSVD.fit" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Train a FunkSVD model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ratings</strong> â the ratings data frame.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lenskit.algorithms.funksvd.FunkSVD.predict_for_user">
<span class="sig-name descname"><span class="pre">predict_for_user</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.algorithms.funksvd.FunkSVD.predict_for_user" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Compute predictions for a user and items.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>user</strong> â the user ID</p></li>
<li><p><strong>items</strong> (<em>array-like</em>) â the items to predict</p></li>
<li><p><strong>ratings</strong> (<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v1.2.5)"><em>pandas.Series</em></a>) â the userâs ratings (indexed by item id); if provided, they may be used to
override or augment the modelâs notion of a userâs preferences.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>scores for the items, indexed by item id.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v1.2.5)">pandas.Series</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="tf.html" class="btn btn-neutral float-right" title="TensorFlow Algorithms" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="knn.html" class="btn btn-neutral float-left" title="k-NN Collaborative Filtering" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2018â2019 Boise State University.
      <span class="commit">
        
        Revision <code>0678cd1d</code>.
      </span>

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
<p>This material is based upon work supported by the National Science Foundation under
Grant No. <a href="https://md.ekstrandom.net/research/career">IIS 17-51278</a>. Any
opinions, findings, and conclusions or recommendations expressed in this material
are those of the author(s) and do not necessarily reflect the views of the
National Science Foundation.  This page has not been approved by
Boise State University and does not reflect official university positions.</p>
<script data-goatcounter="https://lenskit.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>


</footer>
        </div>
      </div>

    </section>

  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: 0.13.1
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
        
          <dd><a href="/en/latest/">latest</a></dd>
        
          <dd><a href="/en/stable/">stable</a></dd>
        
          <dd><a href="/en/0.13.1/">0.13.1</a></dd>
        
          <dd><a href="/en/0.13.0/">0.13.0</a></dd>
        
          <dd><a href="/en/0.12.3/">0.12.3</a></dd>
        
          <dd><a href="/en/0.12.2/">0.12.2</a></dd>
        
          <dd><a href="/en/0.12.1/">0.12.1</a></dd>
        
          <dd><a href="/en/0.12.0/">0.12.0</a></dd>
        
          <dd><a href="/en/0.11.1/">0.11.1</a></dd>
        
          <dd><a href="/en/0.11.0/">0.11.0</a></dd>
        
          <dd><a href="/en/0.10.1/">0.10.1</a></dd>
        
          <dd><a href="/en/0.10.0/">0.10.0</a></dd>
        
          <dd><a href="/en/0.9.0/">0.9.0</a></dd>
        
          <dd><a href="/en/0.8.4/">0.8.4</a></dd>
        
          <dd><a href="/en/0.8.1/">0.8.1</a></dd>
        
          <dd><a href="/en/0.8.0/">0.8.0</a></dd>
        
          <dd><a href="/en/0.7.0/">0.7.0</a></dd>
        
          <dd><a href="/en/0.6.1/">0.6.1</a></dd>
        
          <dd><a href="/en/0.6.0/">0.6.0</a></dd>
        
          <dd><a href="/en/0.5.0/">0.5.0</a></dd>
        
          <dd><a href="/en/0.3.0/">0.3.0</a></dd>
        
          <dd><a href="/en/0.2.0/">0.2.0</a></dd>
        
          <dd><a href="/en/0.1.0/">0.1.0</a></dd>
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
      </dl>
      <dl>
        
        <dt>On Read the Docs</dt>
          <dd>
            <a href="//readthedocs.org/projects/lkpy/?fromdocs=lkpy">Project Home</a>
          </dd>
          <dd>
            <a href="//readthedocs.org/builds/lkpy/?fromdocs=lkpy">Builds</a>
          </dd>
      </dl>
    </div>
  </div>


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
   

</body>
</html>